<!DOCTYPE html>
<html>
<head>
    <title>Simple Graph Test</title>
    <script src="https://unpkg.com/cytoscape@3.26.0/dist/cytoscape.min.js"></script>
    <style>
        #cy { width: 100%; height: 400px; border: 1px solid #ccc; }
        body { font-family: Arial, sans-serif; margin: 20px; }
    </style>
</head>
<body>
    <h2>Graph Visualization Test</h2>
    <button onclick="loadGraph()">Load Real Graph Data</button>
    <div id="cy"></div>
    
    <script>
        let cy;
        
        // Initialize empty graph
        cy = cytoscape({
            container: document.getElementById('cy'),
            style: [
                {
                    selector: 'node',
                    style: {
                        'background-color': '#3b82f6',
                        'label': 'data(name)',
                        'text-valign': 'center',
                        'color': '#000',
                        'font-size': '10px',
                        'width': 30,
                        'height': 30
                    }
                },
                {
                    selector: 'edge',
                    style: {
                        'curve-style': 'bezier',
                        'target-arrow-shape': 'triangle',
                        'line-color': '#666',
                        'target-arrow-color': '#666',
                        'width': 1
                    }
                }
            ]
        });
        
        async function loadGraph() {
            try {
                console.log('Loading graph data...');
                const response = await fetch('/api/graph/full?node_limit=5');
                const data = await response.json();
                
                console.log('Data received:', data);
                
                if (data.success && data.elements) {
                    cy.elements().remove();
                    cy.add(data.elements);
                    cy.layout({ name: 'circle' }).run();
                    cy.fit();
                    console.log('Graph loaded with', data.elements.length, 'elements');
                } else {
                    console.error('No data received');
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }
    </script>
</body>
</html>